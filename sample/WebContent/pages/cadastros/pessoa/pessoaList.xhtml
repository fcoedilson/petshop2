<?xml version='1.0' encoding='UTF-8'?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:t="http://myfaces.apache.org/tomahawk">


		<fieldset>

			<rich:tabPanel switchType="client">

				<rich:tab label="Pessoa Física">

					<h:panelGrid columns="3" styleClass="crudd" columnClasses="label">

				      	<h:outputLabel value="CPF" />
					    <h:inputText id="cpf" value="#{pessoaBean.cpf}"  styleClass="maskCpf"/>
					    <rich:message for="cpf" styleClass="message"/>

						<h:outputLabel value="Cliente" rendered="#{controlBean.adminSistema}"/>

			    		<h:selectOneMenu id="cliente1" value="#{pessoaBean.cliente}" rendered="#{controlBean.adminSistema}" converter="entityConverter" requiredMessage="Informe o Cliente">
			    			<f:selectItem itemValue="" itemLabel="Todos ..."/>
			    			<t:selectItems value="#{clienteBean.clientes}" var="cli" itemLabel="#{cli.nome}" itemValue="#{cli}"/>
			    		</h:selectOneMenu>
			    		<rich:message for="cliente1" styleClass="message" rendered="#{controlBean.adminSistema}"/>

						<a4j:commandButton value="Pesquisar" action="#{pessoaBean.search}" reRender="dataTable" ajaxSingle="false">
							<a4j:support  event="onclick"  status="statusSearch"/>
						</a4j:commandButton>
	
				      	<a4j:commandButton action="#{pessoaBean.prepareSave}" value="Novo" styleClass="novo" rendered="#{controlBean.adminSistema or controlBean.adminCliente}" reRender="paginaPrincipal" immediate="true"/>

		    		</h:panelGrid>

			      	<rich:dataTable id="dataTable"	value="#{pessoaBean.entities}" var="pessoa" rows="50" rowKeyVar="index"
			      		rowClasses="even, odd" 
			      		onRowMouseOver="jQuery(this).addClass('trHover')" 
						onRowMouseOut="jQuery(this).removeClass('trHover')" width="100%">
						
						<c:if test="#{empty pessoaBean.entities}">
							<rich:column>
								<f:facet name="header">Nenhum registro foi encontrado.</f:facet>
							</rich:column>
						</c:if>
						
						<c:if test="#{not empty pessoaBean.entities}">
		
							<rich:column width="2%" style="text-align: center;" > 
								<f:facet name="header"><h:outputText value="Nº" /></f:facet>
								<h:outputText value="#{index+1}" style="color: black;"/>
							</rich:column>
			
							<rich:column sortBy="#{pessoa.nome}" width="30%" style="text-align: left;" > 
								<f:facet name="header"><h:outputText value="Nome" /></f:facet>
								<h:outputText value="#{pessoa.nome}" style="color: black;"/>
							</rich:column>
							
							<rich:column sortBy="#{pessoa.cpf}" width="15%" style="text-align: left;" > 
								<f:facet name="header"><h:outputText value="CPF" /></f:facet>
								<h:outputText value="#{pessoa.cpf}" style="color: black;"/>
							</rich:column>
			
							<rich:column sortBy="#{pessoa.cliente.nome}" rendered="#{controlBean.adminSistema}" width="30%" style="text-align: left;" > 
								<f:facet name="header"><h:outputText value="Cliente" /></f:facet>
								<h:outputText value="#{pessoa.cliente.nome}" style="color: black;"/>
							</rich:column>
							
							<rich:column width="3%" style="text-align: center;">
								<f:facet name="header"><h:outputText value="Editar" /></f:facet>
								<h:commandLink styleClass="editar" action="#{pessoaBean.prepareUpdate}" value="Editar">
									<f:setPropertyActionListener target="#{pessoaBean.entity}" value="#{pessoa}"/>
									<a4j:support event="onclick" reRender="paginaPrincipal"/>
								</h:commandLink>
							</rich:column>
							
			                <rich:column width="1%" style="text-align: center;" rendered="#{controlBean.adminSistema  or controlBean.adminCliente}">
			                    <f:facet name="header"><h:outputText value="Excluir" /></f:facet>
			                    <a4j:commandLink styleClass="excluir"  action="#{pessoaBean.delete}" 
			                    	reRender="paginaPrincipal" value="Excluir" immediate="true"
			                    	onclick="if(!confirm('Tem certeza que deseja excluir?')){document.getElementById('paginaPrincipal').reset();return false;}" >
			                        <f:setPropertyActionListener target="#{pessoaBean.entity}" value="#{pessoa}"/>
			                    </a4j:commandLink>
			                </rich:column>
			
							<f:facet name="footer">
								<rich:datascroller renderIfSinglePage="false" for="dataTable"/>
			          	 	</f:facet>
		
		          	 	</c:if>

					</rich:dataTable>	

				</rich:tab>	

			</rich:tabPanel>

		</fieldset>

		<a4j:status id="statusSearch">
			<f:facet name="start">
				<h:panelGroup style="align:center;">
					<h:graphicImage value="/images/ajax-loader.gif" height="16" width="16" />
					<h:outputText value="Processando..." styleClass="processando" />
				</h:panelGroup>
			</f:facet>
		</a4j:status>


</ui:composition>